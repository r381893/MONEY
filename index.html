<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“‹ æˆ‘çš„ JSONP ç´€éŒ„æ¿</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family:'Noto Sans TC',sans-serif; background:#f9f9ff; padding:2rem; }
    textarea { width:100%; height:100px; padding:10px; font-size:1rem; }
    button { margin-top:10px; padding:10px 20px; font-size:1rem; background:#6c63ff; color:#fff; border:none; border-radius:5px; }
    ul { list-style:none; padding:0; }
    li { margin:10px 0; padding:10px; background:#fff; border-left:5px solid #6c63ff; box-shadow:0 1px 3px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <h1>ğŸ“‹ æˆ‘çš„ç´€éŒ„æ¿ (JSONP ç‰ˆ)</h1>
  <textarea id="noteInput" placeholder="è«‹è¼¸å…¥ç´€éŒ„..."></textarea><br>
  <button onclick="saveNote()">å„²å­˜ç´€éŒ„</button>

  <h2>ğŸ•˜ æ­·å²ç´€éŒ„</h2>
  <ul id="recordList">è¼‰å…¥ä¸­...</ul>

  <script>
    // ä½ çš„ Web App URL
    const apiUrl = 'https://script.google.com/macros/s/AKfycbxWYBbOsFTxwrArwQLNOqMJcWOMHHe-fqBGtqXgcvy2o7dMyShe2PLS5AL8jKs1WesD/exec';

    // JSONP callbackï¼šæ¥æ”¶è³‡æ–™ä¸¦æ¸²æŸ“åˆ—è¡¨
    function renderNotes(data) {
      const ul = document.getElementById('recordList');
      ul.innerHTML = '';
      data.forEach(item => {
        const li = document.createElement('li');
        li.textContent = `[${item.date} ${item.time}] ${item.content}`;
        ul.appendChild(li);
      });
    }

    // è®€å–æ­·å²ç´€éŒ„ï¼šå‹•æ…‹æ’å…¥ <script>
    function loadNotes() {
      const s = document.createElement('script');
      s.src = apiUrl + '?callback=renderNotes';
      document.body.appendChild(s);
    }

    // å„²å­˜ä¸€ç­†ç´€éŒ„ï¼šcontent æ”¾é€² URL åƒæ•¸ã€callback æŒ‡å‘ saved()
    function saveNote() {
      const txt = document.getElementById('noteInput').value.trim();
      if (!txt) return alert('è«‹è¼¸å…¥å…§å®¹');
      const s = document.createElement('script');
      s.src = apiUrl
             + '?callback=afterSave'
             + '&content=' + encodeURIComponent(txt);
      document.body.appendChild(s);
    }

    // å„²å­˜å®Œæˆå¾Œå†é‡æ–°è¼‰å…¥åˆ—è¡¨
    function afterSave(resp) {
      document.getElementById('noteInput').value = '';
      loadNotes();
    }

    // é é¢ä¸€æ‰“é–‹å°±è¼‰å…¥
    window.onload = loadNotes;
  </script>
</body>
</html>
